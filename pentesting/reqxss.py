import requests
import sys
import signal



if len(sys.argv) != 2:
	exit(f'Usage: python3 {sys.argv[0]} filename')

filename = sys.argv[1]

with open(f'{filename}', 'r') as f:
	urls = [x.strip() for x in f.read().split('\n')]

print('Vulnerable to XSS: \n')

for url in urls:
	try:
		r = requests.get(url, timeout=5)
		if 'alert(1)' in r.text:
			print(url)
	except requests.exceptions.RequestException:
		pass
