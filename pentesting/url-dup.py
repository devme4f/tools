from urllib import parse
import sys

if len(sys.argv) != 3:
	exit(f'Usage: python3 {sys.argv[0]} filename payload')

filename = str(sys.argv[1])
payload = str(sys.argv[2])

with open(filename, 'r') as f:
	urls = [x.strip() for x in f.read().split('\n')]

def format_url(url, payload):
	u = parse.urlsplit(url)
	key = list(parse.parse_qs(u.query).keys())
	length = len(key)

	d = u.scheme + "://" + u.netloc + u.path
	d += '?' + str(key[0]) + '=' + payload
	if length > 1:
		for i in range(length-1):
			d += '&' + key[i+1] + '=' + payload

	return d

results = []

for url in urls:
	results.append(format_url(url, payload))

results = list(set(results))

with open(filename + '.done', 'w') as f:
	for r in results:
		f.write(r+'\n')
